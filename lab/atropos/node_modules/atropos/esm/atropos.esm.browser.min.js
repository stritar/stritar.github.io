/**
 * Atropos 0.9.6
 * Touch-friendly 3D parallax hover effects
 * https://atroposjs.com
 *
 * Copyright 2021-2021 
 *
 * Released under the MIT License
 *
 * Released on: September 28, 2021
 */

function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var $=function(t,e){return t.querySelector(e)},$$=function(t,e){return t.querySelectorAll(e)},$setDuration=function(t,e){t.style.transitionDuration=e},$setTransform=function(t,e){t.style.transform=e},$setOpacity=function(t,e){t.style.opacity=e},$on=function(t,e,o,a){return t.addEventListener(e,o,a)},$off=function(t,e,o,a){return t.removeEventListener(e,o,a)},removeUndefinedProps=function(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(o){void 0!==t[o]&&(e[o]=t[o])})),e};function Atropos(t){void 0===t&&(t={});var e,o,a,r,n,s,i,p,c,u,f=t,d=f.el,l=f.eventsEl,v={__atropos__:!0,params:_extends({activeOffset:50,shadowOffset:50,shadowScale:1,durationEnter:300,durationLeave:600,rotateLock:!0,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},removeUndefinedProps(t||{})),destroyed:!1,isActive:!1},m=v.params,h=!0,y=!0,g=function(t){var e=t.rotateXPercentage,o=void 0===e?0:e,a=t.rotateYPercentage,r=void 0===a?0:a,n=t.duration,s=t.opacityOnly;$$(d,"[data-atropos-offset], [data-atropos-opacity]").forEach((function(t){$setDuration(t,n);var e=function(t){if(t.dataset.atroposOpacity&&"string"==typeof t.dataset.atroposOpacity)return t.dataset.atroposOpacity.split(";").map((function(t){return parseFloat(t)}))}(t);if(0===o&&0===r)s||$setTransform(t,"translate3d(0, 0, 0)"),e&&$setOpacity(t,e[0]);else{var a=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(a)||s||$setTransform(t,"translate3d("+-r*-a+"%, "+o*-a+"%, 0)"),e){var i=e[0],p=e[1],c=Math.max(Math.abs(o),Math.abs(r));$setOpacity(t,i+(p-i)*c/100)}}}))},L=function(t){"pointerdown"===t.type&&"mouse"===t.pointerType||"pointerenter"===t.type&&"mouse"!==t.pointerType||("pointerdown"===t.type&&t.preventDefault(),d.classList.add("atropos-active"),$setDuration(e,"0ms"),o=!1,n=void 0,s=void 0,h=!0,y=!0,$setTransform(a,"translate3d(0,0, "+m.activeOffset+"px)"),$setDuration(a,(m.rotateLock?m.durationEnter:0)+"ms"),p&&$setDuration(p,(m.rotateLock?m.durationEnter:0)+"ms"),v.isActive=!0,"function"==typeof m.onEnter&&m.onEnter())},T=function(t){o&&t.cancelable&&t.preventDefault()},x=function(t){if(m.rotate&&v.isActive){if("mouse"!==t.pointerType){if(!m.rotateTouch)return;t.preventDefault()}var a=t.clientX,r=t.clientY;i||(i=d.getBoundingClientRect());var p=i,u=p.top,f=p.left,l=p.width,$=p.height,L=l/2,T=$/2,x=a-f,M=r-u,_=m.rotateYMax*(x-L)/(l/2)*-1,O=m.rotateXMax*(M-T)/($/2);m.rotateLock&&(void 0===s&&(s=_,y=!0),void 0===n&&(n=O,h=!0),y&&(s<0&&(_<0&&(_=0),_>0&&(y=!1)),s>0&&(_>0&&(_=0),_<0&&(y=!1))),h&&(n<0&&(O<0&&(O=0),O>0&&(h=!1)),n>0&&(O>0&&(O=0),O<0&&(h=!1)))),O=Math.min(Math.max(-O,-m.rotateXMax),m.rotateXMax),m.rotateXInvert&&(O=-O),_=Math.min(Math.max(-_,-m.rotateYMax),m.rotateYMax),m.rotateYInvert&&(_=-_),"string"!=typeof m.rotateTouch||0===O&&0===_||(o||(o=!0,d.classList.add("atropos-rotate-touch")),t.cancelable&&t.preventDefault()),$setTransform(e,"translate3d(0,0,0) rotateX("+O+"deg) rotateY("+_+"deg)");var D=O/m.rotateXMax*100,w=_/m.rotateYMax*100;c&&($setDuration(c,"0ms"),$setTransform(c,"translate3d("+.25*-w+"%, "+.25*D+"%, 0)"),c.style.opacity=Math.max(Math.abs(D),Math.abs(w))/100),g({rotateXPercentage:D,rotateYPercentage:w,duration:"0ms"}),"function"==typeof m.onRotate&&m.onRotate(O,_)}},M=function(t){i=void 0,v.isActive&&(t&&"pointerup"===t.type&&"mouse"===t.pointerType||t&&"pointerleave"===t.type&&"mouse"!==t.pointerType||("string"==typeof m.rotateTouch&&o&&d.classList.remove("atropos-rotate-touch"),d.classList.remove("atropos-active"),$setTransform(a,"translate3d(0,0, 0px)"),$setDuration(a,m.durationLeave+"ms"),p&&$setDuration(p,m.durationLeave+"ms"),c&&($setDuration(c,m.durationLeave+"ms"),$setTransform(c,"translate3d(0, 0, 0)"),c.style.opacity=0),$setDuration(e,m.durationLeave+"ms"),$setTransform(e,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),g({duration:m.durationLeave+"ms"}),v.isActive=!1,"function"==typeof m.onRotate&&m.onRotate(0,0),"function"==typeof m.onLeave&&m.onLeave()))},_=function(t){var e=t.target;!d.contains(e)&&e!==d&&v.isActive&&M()};return v.destroy=function(){v.destroyed=!0,$off(document,"click",_),$off(l,"pointerdown",L),$off(l,"pointerenter",L),$off(l,"pointermove",x),$off(l,"touchmove",T),$off(l,"pointerleave",M),$off(l,"pointerup",M),$off(l,"lostpointercapture",M),delete d.__atropos__},"string"==typeof d&&(d=$(document,d)),d&&(d.__atropos__||(void 0!==l?"string"==typeof l&&(l=$(document,l)):l=d,Object.assign(v,{el:d}),e=$(d,".atropos-rotate"),a=$(d,".atropos-scale"),r=$(d,".atropos-inner"),d.__atropos__=v)),d&&l&&(m.shadow&&((p=$(d,".atropos-shadow"))||((p=document.createElement("span")).classList.add("atropos-shadow"),u=!0),$setTransform(p,"translate3d(0,0,-"+m.shadowOffset+"px) scale("+m.shadowScale+")"),u&&e.appendChild(p)),m.highlight&&function(){var t;(c=$(d,".atropos-highlight"))||((c=document.createElement("span")).classList.add("atropos-highlight"),t=!0),$setTransform(c,"translate3d(0,0,0)"),t&&r.appendChild(c)}(),m.rotateTouch&&("string"==typeof m.rotateTouch?d.classList.add("atropos-rotate-touch-"+m.rotateTouch):d.classList.add("atropos-rotate-touch")),$(d,"[data-atropos-opacity]")&&g({opacityOnly:!0}),$on(document,"click",_),$on(l,"pointerdown",L),$on(l,"pointerenter",L),$on(l,"pointermove",x),$on(l,"touchmove",T),$on(l,"pointerleave",M),$on(l,"pointerup",M),$on(l,"lostpointercapture",M)),v}export default Atropos;export{Atropos};
//# sourceMappingURL=atropos.esm.browser.min.js.map